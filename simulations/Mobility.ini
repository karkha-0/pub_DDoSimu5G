[General]
description = "Base configuration, do not run this config!"
############### Simualtion configuration ##################
sim-time-limit = 60s	 # 1 hour  
warmup-period = 1s 
repeat = 2
seed-set = ${repetition} 

#image-path = ../image/background
#
#parallel-simulation = true
#parsim-num-partitions = 4
#parsim-communications-class = "cMPICommunications"
#parsim-synchronization-class = "cNullMessageProtocol"

# Note binder need to be with upf, gnb, carrierAggregation, iupf, ue
# Note server need to be in connection with gnb
# Note channelcontrol need to be with gnb
# Note configurator need to be with gnb

#Assign partitions 
#**.partition-id = 0
#**channelControl.partition-id = 1
#**routingRecorder.partition-id = 1
#**configurator.partition-id = 1
#**binder.partition-id = 1
#**carrierAggregation.partition-id = 1
#**server.partition-id = 1
#**router.partition-id = 1
#**upf.partition-id = 1
#**iUpf.partition-id = 1
#
## Assign gNodeBs and UEs to partitions
#**.gnb1.partition-id = 1
#**.gnb2.partition-id = 1
#**.gnb3.partition-id = 1
###
##**.ue[*].partition-id = intuniform(1,3) # Randomly assign UEs to partitions
#**.ue[*].partition-id = 1 # Randomly assign UEs to partitions
# --------------------------------------------------------# 

############### Network configuration ##################
*.configurator.config = xmldoc("CaseID/config/demo.xml") 
# --------------------------------------------------------# 

############### Statistics ##################
output-scalar-file-append = false
**.routingRecorder.enabled = false
record-eventlog = false

**.servingCell*.vector-recording = true
**.servedUE*.vector-recording = true
**.testMsg*.vector-recording = true
**.simNodeIds*.vector-recording = true


**.macBufferOverFlowDl*.vector-recording = false
**.macBufferOverflowUl*.vector-recording = false


**.scalar-recording = false
**.vector-recording = false	

# include itervars in the output file names 
output-scalar-file = ../${resultdir}/${configname}/${iterationvars}-repit-${repetition}.sca 
output-vector-file = ../${resultdir}/${configname}/${iterationvars}-repit-${repetition}.vec 
# --------------------------------------------------------# 

# --------------------------------------------------------# 
# Config "Mutliple-Cell" 
# 
# 
# 
[Config Sim-Network]
################ NED config setting #############
#network = networks.MultiCell
network = Mobility # This is because i added the ned files needed through the project properties
description = "Base configuration, do not run this config!"
# --------------------------------------------------------#

############### General PHY parameters ##############
**.downlink_interference = true
**.uplink_interference = true
**.ueTxPower = 26
**.eNodeBTxPower = 46
**.targetBler = 0.01
**.blerShift = 5  
**.fbPeriod = 40   # reports CQI every 40ms

############# Floorplan parameters ################
**.mobility.constraintAreaMaxX = 2000m
**.mobility.constraintAreaMaxY = 2000m
**.mobility.constraintAreaMinX = 0m
**.mobility.constraintAreaMinY = 250m
**.mobility.constraintAreaMinZ = 0m
**.mobility.constraintAreaMaxZ = 0m
**.mobility.initFromDisplayString = false

############### CA configuration ################# 
*.carrierAggregation.numComponentCarriers = 1
*.carrierAggregation.componentCarrier[0].numerologyIndex = ${u=0}
*.carrierAggregation.componentCarrier[0].carrierFrequency = 2GHz
*.carrierAggregation.componentCarrier[0].numBands = ${numRbs=40}

*.gnb*.cellularNic.numCarriers = 1
*.gnb*.cellularNic.channelModel[0].componentCarrierIndex = 0
*.ue[*].cellularNic.numCarriers = 1
*.ue[*].cellularNic.nrChannelModel[0].componentCarrierIndex = 0

############### BS position #################
*.gnb1.mobility.initialX = 300m
*.gnb1.mobility.initialY = 300m
*.gnb2.mobility.initialX = 900m
*.gnb2.mobility.initialY = 300m
*.gnb3.mobility.initialX = 1500m
*.gnb3.mobility.initialY = 300m


############### X2 configuration #################
*.gnb*.numX2Apps = 2                                        # one x2App per peering node
*.gnb*.x2App[*].server.localPort = 5000 + ancestorIndex(1)  # Server ports (x2App[0]=5000, x2App[1]=5001, ...)

*.gnb1.x2App[0].client.connectAddress = "gnb2%x2ppp0"
*.gnb1.x2App[1].client.connectAddress = "gnb3%x2ppp0"

*.gnb2.x2App[0].client.connectAddress = "gnb1%x2ppp0"
*.gnb2.x2App[1].client.connectAddress = "gnb3%x2ppp1"

*.gnb3.x2App[0].client.connectAddress = "gnb1%x2ppp0"
*.gnb3.x2App[1].client.connectAddress = "gnb2%x2ppp1"


# --------------------------------------------------------# 
# Config "Mobility-dataset" 
# 
#   
# 
# 
[Config Mobility-dataset]
extends = Sim-Network
description = "Mutiple gNodeBs with a 1,10,30,100,250,300,500,1000,3000,5000,10000 UEs"

############## UE configuration ##################
*.numUe = ${numUEs=1,10,30,100,250,300,500,1000,3000,5000,10000}
#*.numUe = 10

#**.ueIdOffset = ${0,100,200,300}
**.ueIdOffset = ${repetition}*${numUEs}
#**.ueIdOffset = 10

# UEs associates to the best BS at the beginning of the simulation
*.ue[*].macCellId = 0
*.ue[*].masterId = 0
#*.ue[*].nrMacCellId = 1
#*.ue[*].nrMasterId = 1
*.ue[*].nrMacCellId = intuniform(1,3) # randomly allocate the UEs to the NR cells
*.ue[*].nrMasterId = intuniform(1,3)  # randomly allocate the UEs to the NR cells
**.dynamicCellAssociation = true
**.enableHandover = true

############ UEs position #################
*.ue[*].mobility.typename = "LinearMobility"
#*.ue[*].mobility.initialX = uniform(0m,1000m)
#*.ue[*].mobility.initialY = uniform(250m,750m)
*.ue[*].mobility.speed = uniform(20mps,80mps)
